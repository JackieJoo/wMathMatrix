# Введення

В даній статті виконується огляд концепції матриці та її форматів задання.

Математичні алгоритми мають бути незалежними від типу даних і формату матриці. Цей модуль обертається накого цього принципу.

### Концепція матриця

Під матрицею в даному модулі розуміється вектор даних впорядкований в вигляді матриці. Матриця не є об'єктом, а абстракцією.

Неймспейс `Matrix` - це реалізація абстрактного інтерфейса, різновиду посилання, що задає спосіб інтерпретації даних, як матриці.

### Задання матриці

Для створення інстансу використовується конструктор класу `_.Matrix` або рутини неймспейсу `_.Matrix`.

Дані для матриці можуть задаватись будь-яким форматом [вектора](https://github.com/Wandalen/wMathVector).

### Створення матриці визначеного розміру

Для створення матриці визначеного розміру використовуєтья рутина `make`. Рутина створює інстанс матриці і виділяє ініціалізовану ділянку пам'яті для даних.

```js
var matrix = _.Matrix.make( [ 3, 3 ] );
console.log( matrix.buffer );
/* log Float32Array [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ] */
matrix.copy( [ 1, 2, 3, 4, 5, 6, 7, 8, 9 ] );
console.log( matrix.buffer );
/* log Float32Array [ 1, 4, 7, 2, 5, 8, 3, 6, 9 ] */
```

Рутина `make` приймає параметром масив з двома елементами `dims`. Перший елемент визначає довжину рядка матриці `row`, другий - довжину стовпчика `col`.

Для заповнення матриці використовується рутина `copy`. Буфер матриці заповнюється переданими значеннями.

### Виконання простої операції

Для виконання операції з матрицею потрібно викликати відповідний метод у інстанса.

```js
var matrix = _.Matrix.make( [ 3, 3 ] ).copy
([
  1, 2, 3,
  4, 5, 6,
  7, 8, -9
]);
var got = matrix.determinant();
console.log( got );
/* log 54 */
```

### Використання опції strides

Опція `strides` дає зрозуміти як інтерпретувати матрицю. Опція `strides` - двоелементний масив. Перший елемент вказує на довжину рядка, другий на крок зчитування.

```js
var matrix = _.Matrix.make( [ 3, 3 ] ).copy
([
  1, 2, 3,
  4, 5, 6,
  7, 8, -9
]);
matrix.strides = [ 3, 2 ];
var got = matrix.rowVectorGet( 0 );
console.log( got );
/* log
VectorAdapterFromLongShrinkedWithStrideNumberShrinkView {
  _vectorBuffer: Float32Array [ 1, 4, 7, 2, 5, 8, 3, 6, -9 ],
  length: 3,
  offset: 0,
  stride: 2
} */
```

Використовуючи предтавлені дані можна порахувати, що перший рядок матиме значення `[ 1, 7, 5 ]`, другий матиме зміщення `+1` - `[ 4, 2, 8 ]`, а третій перекриватиметься з першим - `[ 7, 5, 3 ]`. Для реалізації такої матриці можна використати буфер на 2 елементи менше.

```js
var matrix = _.Matrix
({
  dims : [ 3, 3 ],
  strides : [ 3, 2 ],
  buffer : [ 1, 2, 3, 4, 5, 6, 7 ],
});
```

Для створення інстансу використано конструктор `_.Matrix`. В нього передано відповідні опції.

### Транспонування матриці

Для транспонування матриці достатньо змінити другий елемент опції `strides` на значення `1`. Це дозволить інтерпретувати стовпчики матриці як рядки.

```js
var matrix = _.Matrix.make( [ 3, 3 ] ).copy
([
  1, 2, 3,
  4, 5, 6,
  7, 8, -9
]);
matrix.dims = [ 3, 2 ];
var got = matrix.rowVectorGet( 0 );
console.log( got );
/* log
VectorAdapterFromLongShrinked {
  _vectorBuffer: Float32Array [ 1, 4, 7, 2, 5, 8, 3, 6, -9 ],
  length: 3,
  offset: 0,
} */
```

Перший рядок використовує три елементи буферу починаючи з першого - `[ 1, 4, 7 ]`, другий зі зміщенням `+3` - `[ 2, 5, 8 ]`, а третій - `[ 3, 6, -9 ]`.

### Рішення системи лінійних рівнянь

Рішення системи з двох лінійних рівнянь

```
3*x1 - 2*x2 = 1;
2*x1 + 3*x2 = 2;
```

Знайти невідомі значення можна перемноживши інвертовану матрицю коефіцієнтів на матрицю значень.

```js
var matrixA = _.Matrix.make( [ 2, 2 ] ).copy( [ 3, -2, 2, 3 ] );
var matrixB = _.Matrix.make( [ 2, 1 ] ).copy( [ 1, 2 ] );

var matrixAInv =  matrixA.invertingClone();
var matrixX = _.Matrix.mul( null, [ matrixAInv, matrixB ] );

var x1 = matrixX.eGet( 0 ).eGet( 0 );
var x2 = matrixX.eGet( 0 ).eGet( 1 );
console.log( x1, x2 )
/* log 0.5384615659713745 0.307692289352417 */
```

Приведений приклад показує, що для створення інвертованої матриці використовується метод `invertingClone`. Інвертована матриця має власний інстанс і контейнер. Для множення матриць використовується рутина `mul`. Для того, щоб результат був поміщений в новий інстанс першим аргументом передано `null`.

[Повернутись до змісту](../README.md#Туторіали)
